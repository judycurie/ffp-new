# **Week09.** Output Devices


|Assignment    |                          |
| ----------- | ------------------------------------ |
| *group*       |  measure the power consumption of an output device|
| *individual*      |   add an output device to a microcontroller board you've designed, and program it to do something|


## Photo of the week

![](../images/week09/photo-of-the-week8.png)


## Lecture Notes

![](../images/week09/week9n.png)
![](../images/week09/week9n2.png)
![](../images/week09/week9n3.png)
![](../images/week09/week9n4.png)

## Take aways from the group Assignment
[Group Assignment](https://fabacademy.org/2023/labs/ciudadmexico/group%20assignments/output-devices).

 - more W more power consumption



## Output devices

![](../images/week09/week9.png)
**Fig.** The schematic of the pin connection of the board to connect OI devices.

### Step motor


Servo Futaba S3003 [producent specification](https://www.fishfun.nl/index.php/modelbouw/servo-s/servo-futaba-s3003.html)



### Code MicroPython

MicroPython Stepper Motor - rotate with specified angle - based on the examples
```
from machine import Pin, PWM
class SERVO:
    def __init__(self, pin):
        self.pin = pin
        self.pwm = PWM(self.pin)
    def turn(self, val):
        self.pwm.freq(100)
        self.pwm.duty_u16(int(val/180*13000+4000))

p = Pin(6, Pin.OUT)

s = SERVO(p)
s.turn(0) # 0 - moves it to 0 position, steps 30, 60, 90
```

<video width="960"  controls>
  <source src="../../images/week09/WhatsApp Video 2023-03-26 at 20.45.44.mp4" type="video/mp4">
</video>


MicroPython Stepper Motor - generated by GPT chat *micropython code for continous rotation of the step motor*
```
import machine
import time

# Define pins for stepper motor
step_pin = machine.Pin(6, machine.Pin.OUT) #default pin 5
dir_pin = machine.Pin(6, machine.Pin.OUT) #default pin 4

# Set initial direction
dir_pin.value(0)  # 0 for clockwise rotation, 1 for counterclockwise

# Set up PWM for controlling speed
pwm = machine.PWM(step_pin)
pwm.freq(200)  # Set PWM frequency to 1 kHz, set frequancies 200,500,1000,2000,5000

# Rotate motor continuously
while True:
    pwm.duty_u16(32768)  # Set duty cycle to 50%
    time.sleep(0.001)  # Wait for some time to allow motor to move
```
<video width="960"  controls>
  <source src="../../images/week09/WhatsApp Video 2023-03-26 at 20.43.11.mp4" type="video/mp4">
</video>

## New Board designed

During testing the board produced in week08 I noticed that the swith button doesn't work correctly.

- redesigning the button trases layout
- min. trace width: 0.6
- clearnace - 0.8 mm
- pad sizes: 3.0x1.8mm (pin headers and microcontroller) 2.2 x 1.8mm (resistors and LED), 2.6 x 1.8mm ( button), 3.15mm x 1.2mm - vertical pin header (-Right click on pad -> Properties -> change size in the window
-Right click on a modified pad  -> Push pad properties on other pads -> Change pads on current)
 - removing not necessary Cu layer for easier soldering of the components

 footprint
![](../images/week09/xxino22c- bigger pads-F_Cu-pictureframe.png)
**Fig.** The new PCB board traces.
![](../images/week09/week9-xino22.png)
**Fig.** The schematic of the pin connection of the new board to connect OI devices.
![](../images/week09/xino22.jpg)
**Fig.** The schematic model and case for the new board.









## Problems/Questions/Dilemas
1. The motor stops at some frequances
